<html>
    <head>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/1.3.5/socket.io.min.js"></script>
    <script>
    	var socket = io('http://127.0.0.1:8991');
	var initialised = false;
	var name = null;
	const baud = 9600;
	var data = "";
    	socket.on('message', function(event) {
		console.log(event);
		if (!initialised) {
			socket.emit('command', 'list');
			initialised = true;
		}
		else if (event.Ports) {
			if (!event.Network) {
				name = event.Ports[0].Name;
				console.log(`open ${name} ${baud}`);
				socket.emit('command', `open ${name} ${baud}`);
			}
		}
		else {
			data += event.D ;
			if (event.D=='\n') {
				console.log(data);
				data = "";
			}
		}
	});
    </script>
    </head>
    <body>
    <h1>Arduino Agent</h1>
    </body>
</html>
